(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30880,        648]
NotebookOptionsPosition[     29469,        620]
NotebookOutlinePosition[     29807,        635]
CellTagsIndexPosition[     29764,        632]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "g", ",", "T", ",", "E0", ",", "h0", ",", "h1", ",", "sum", ",", " ", "nF", 
   ",", " ", "nFlist", ",", "\[Mu]matrix", ",", "\[Nu]List", ",", 
   "\[Nu]AbsList", ",", "M", ",", "denominatorlist", ",", "gList", ",", 
   "TList"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ns", "=", "250."}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "atoms", " ", "in", " ", "state", " ", "s"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    RowBox[{"IntegerPart", "[", 
     RowBox[{"2", "*", "Ns"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Length", " ", "box"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TF", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EF", "=", "0."}], ";"}]}], "Input",
 CellChangeTimes->{{3.822989357034368*^9, 3.822989381299777*^9}, {
   3.8229930084203167`*^9, 3.82299301265387*^9}, {3.822997721324524*^9, 
   3.822997723867938*^9}, {3.823068007815637*^9, 3.8230680122297583`*^9}, {
   3.8230680473265038`*^9, 3.823068082281666*^9}, {3.82307136645959*^9, 
   3.823071368803856*^9}, {3.823074599857586*^9, 3.823074600527316*^9}, {
   3.82307463584956*^9, 3.8230747365825863`*^9}, {3.823077488312112*^9, 
   3.823077503506029*^9}, {3.823338476066271*^9, 3.8233384772345257`*^9}, {
   3.823340392163724*^9, 3.823340392603505*^9}, 3.8238445144507093`*^9, 
   3.8238493015993223`*^9, {3.823855777594096*^9, 3.8238557788323*^9}, {
   3.823856004205657*^9, 3.823856022421863*^9}, 3.823856244593457*^9, {
   3.823856394284319*^9, 3.823856397677459*^9}, {3.823856568744007*^9, 
   3.8238565728277607`*^9}, {3.823856820578581*^9, 3.823856823789324*^9}, {
   3.823858052975806*^9, 3.8238580531589737`*^9}, {3.8238620297816668`*^9, 
   3.8238620368529253`*^9}, {3.823862294789616*^9, 3.8238622950625143`*^9}, {
   3.823862351323022*^9, 3.8238623515394087`*^9}, {3.823862507986557*^9, 
   3.82386251121005*^9}, {3.823862611814028*^9, 3.823862612684195*^9}, {
   3.8238648806523037`*^9, 3.823864884624913*^9}, {3.8238654603357353`*^9, 
   3.823865460464711*^9}, {3.823867127456923*^9, 3.823867128812338*^9}, {
   3.823882216969987*^9, 3.8238822172935667`*^9}, {3.8238825648170977`*^9, 
   3.823882565320015*^9}, {3.823888107634532*^9, 3.8238881448757067`*^9}, {
   3.8238882369325933`*^9, 3.823888240833452*^9}, {3.823929557435198*^9, 
   3.8239295602108393`*^9}, {3.824382626505452*^9, 3.824382633958893*^9}, {
   3.824382886882203*^9, 3.824382887070713*^9}, {3.82438503434268*^9, 
   3.824385035224365*^9}, 3.824385674025269*^9, {3.83646889090265*^9, 
   3.836468891220049*^9}, {3.836474449596418*^9, 3.836474450129654*^9}, {
   3.836483116809464*^9, 3.83648311710222*^9}, {3.8364879822905293`*^9, 
   3.8364879830250397`*^9}, {3.8364991767791224`*^9, 3.836499177174931*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"93f06ac2-1b44-4190-8fae-7347796b9841"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T3", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", "T2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmax", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "1"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"set", " ", "coupling", " ", "strength"}], "*)"}], 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.822989398595297*^9, 3.8229894076293373`*^9}, 
   3.823068074728559*^9, {3.823084260269953*^9, 3.8230842604598503`*^9}, 
   3.823085334389081*^9, {3.823086208474118*^9, 3.82308621172303*^9}, {
   3.823087975256042*^9, 3.8230879772035837`*^9}, {3.823088236914534*^9, 
   3.823088237046865*^9}, {3.823091054263997*^9, 3.823091054433852*^9}, {
   3.8230940460060453`*^9, 3.823094047125304*^9}, 3.823156844026092*^9, {
   3.8231570077595663`*^9, 3.823157008038766*^9}, {3.823157138297346*^9, 
   3.82315714030687*^9}, {3.823157327100881*^9, 3.823157328842358*^9}, {
   3.8231574991424847`*^9, 3.823157499357497*^9}, {3.823338259546405*^9, 
   3.823338260176094*^9}, {3.823339167978878*^9, 3.82333916937432*^9}, {
   3.823679179176269*^9, 3.82367918057936*^9}, {3.8236792837900553`*^9, 
   3.823679286150234*^9}, {3.823680066365756*^9, 3.8236800673558817`*^9}, {
   3.823850746036181*^9, 3.8238507483980293`*^9}, {3.823850839843829*^9, 
   3.823850840772943*^9}, {3.823851434233382*^9, 3.823851434822083*^9}, {
   3.823851839194449*^9, 3.823851839901724*^9}, {3.823852138360886*^9, 
   3.823852139336247*^9}, {3.823854723075541*^9, 3.823854723609833*^9}, {
   3.823855411238398*^9, 3.823855411996266*^9}, {3.823855774528167*^9, 
   3.8238557759929543`*^9}, {3.8238565852614193`*^9, 3.823856588171505*^9}, {
   3.8238583946995792`*^9, 3.823858394850095*^9}, {3.823858620186344*^9, 
   3.823858620377678*^9}, {3.823858961303837*^9, 3.823858964808343*^9}, {
   3.823859267581706*^9, 3.823859267770652*^9}, {3.823859643619438*^9, 
   3.8238596437187347`*^9}, {3.8238604464548063`*^9, 3.823860448473442*^9}, {
   3.823861051225236*^9, 3.8238610514055243`*^9}, {3.823861306366727*^9, 
   3.823861306492614*^9}, {3.823861760156962*^9, 3.823861765832855*^9}, {
   3.823862745237475*^9, 3.823862745393997*^9}, {3.823863002526067*^9, 
   3.823863002696824*^9}, {3.823863448975999*^9, 3.8238634515541*^9}, {
   3.8238635883580017`*^9, 3.8238635885283203`*^9}, {3.823863722974464*^9, 
   3.82386372307933*^9}, {3.823863979388373*^9, 3.8238639812106047`*^9}, {
   3.82386431293431*^9, 3.823864313059393*^9}, {3.823864437871847*^9, 
   3.823864438082756*^9}, {3.823864603779345*^9, 3.82386460587158*^9}, {
   3.823930458200179*^9, 3.823930458336608*^9}, {3.823930963419393*^9, 
   3.823930963528502*^9}, {3.823931528418531*^9, 3.823931532042259*^9}, {
   3.823934712484981*^9, 3.823934712642667*^9}, {3.823935854845585*^9, 
   3.8239358550082808`*^9}, {3.823937796602417*^9, 3.8239377993566647`*^9}, {
   3.8239400491382313`*^9, 3.8239400493138533`*^9}, {3.8239409308525352`*^9, 
   3.8239409309939833`*^9}, {3.824382617704927*^9, 3.824382623562376*^9}, {
   3.824382793107616*^9, 3.8243827938185053`*^9}, {3.8243830488633747`*^9, 
   3.8243830490484037`*^9}, {3.82438419679279*^9, 3.82438419782001*^9}, {
   3.824384543474779*^9, 3.824384558844329*^9}, {3.824384701325491*^9, 
   3.824384742027927*^9}, {3.824384922638784*^9, 3.824385029913992*^9}, {
   3.824385137422749*^9, 3.824385138058671*^9}, {3.8243852996568193`*^9, 
   3.8243854035045958`*^9}, {3.824385615484847*^9, 3.824385672315427*^9}, {
   3.8243892073349037`*^9, 3.824389209930976*^9}, 3.824389260669726*^9, {
   3.8243897074017553`*^9, 3.824389709044258*^9}, {3.824453591647437*^9, 
   3.8244535928773117`*^9}, {3.825157194338161*^9, 3.82515719831322*^9}, {
   3.8254032680106783`*^9, 3.825403272299295*^9}, {3.8254034036548862`*^9, 
   3.825403403770165*^9}, {3.825404390283762*^9, 3.825404392684258*^9}, {
   3.825404523605641*^9, 3.8254045237232733`*^9}, {3.825405191249606*^9, 
   3.825405191378682*^9}, {3.825406338476674*^9, 3.825406342898015*^9}, {
   3.825406741813409*^9, 3.825406741942102*^9}, {3.825407170044195*^9, 
   3.8254071701807833`*^9}, {3.825412527678632*^9, 3.825412534079866*^9}, {
   3.825426385203663*^9, 3.825426391532297*^9}, {3.8255002465487337`*^9, 
   3.825500252892639*^9}, {3.825500325990559*^9, 3.8255003307588453`*^9}, {
   3.825507837809381*^9, 3.825507837920506*^9}, {3.825508069989633*^9, 
   3.825508070956648*^9}, {3.8255775095891857`*^9, 3.8255775100296593`*^9}, {
   3.825578822551462*^9, 3.825578824920779*^9}, 3.825579249566128*^9, 
   3.825579548308577*^9, {3.8255797511734257`*^9, 3.8255797515049467`*^9}, {
   3.825579982977826*^9, 3.8255799830824842`*^9}, {3.82558090293211*^9, 
   3.825580904032218*^9}, {3.8255810599165277`*^9, 3.825581060521847*^9}, {
   3.827393181625546*^9, 3.8273931830982656`*^9}, 3.827399128222084*^9, {
   3.836324227600218*^9, 3.836324234295126*^9}, {3.836324372434806*^9, 
   3.8363243786939983`*^9}, {3.836324548568296*^9, 3.836324548734191*^9}, {
   3.836378012999255*^9, 3.8363780132022877`*^9}, {3.836378535063757*^9, 
   3.836378535466867*^9}, {3.836379062813706*^9, 3.83637906595287*^9}, {
   3.8363798016999197`*^9, 3.836379802014317*^9}, {3.836381834610702*^9, 
   3.836381834872875*^9}, {3.836382716826643*^9, 3.8363827189273863`*^9}, {
   3.8363834998184032`*^9, 3.836383502213719*^9}, {3.8364667460588617`*^9, 
   3.836466746221672*^9}, {3.83646816295008*^9, 3.8364681632218227`*^9}, {
   3.836474637364284*^9, 3.836474639617939*^9}, {3.836474800913093*^9, 
   3.836474803998111*^9}, {3.8364759815808077`*^9, 3.836475986114626*^9}, {
   3.836482228010376*^9, 3.836482231417863*^9}, {3.8826186842999268`*^9, 
   3.8826186847465687`*^9}, {3.882619140133603*^9, 
   3.88261915485203*^9}},ExpressionUUID->"246e4b5a-a216-488c-8a27-\
9a04c76ec6e4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Tunnelling", " ", "Hamiltonian"}], "*)"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"98c52fe7-8b34-4013-ba1d-c51a1f7d6f29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", "/", "2."}], ",", 
     RowBox[{"L", "-", "1"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H0", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"d", ",", "1"}], "]"}]}], "-", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"d", ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H0", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"H0", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "L"}], "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[CapitalOmega]"}], "/", "2."}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H0", "=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"H0", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"L", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "\[CapitalOmega]"}], "/", "2."}]}]}], "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"View", " ", "as", " ", "matrix"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"H0", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Interaction", " ", "Hamiltonian"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Mp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", "Mp"}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"L", "-", "Mp"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"d2", "/", "Mp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "=", 
   RowBox[{"H0", "+", 
    RowBox[{"g", " ", "V"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.822989424705098*^9, 3.8229894322340393`*^9}, {
   3.822993245059613*^9, 3.8229932485049963`*^9}, {3.822993624431518*^9, 
   3.822993624923649*^9}, {3.8229938272812767`*^9, 3.822993851494309*^9}, {
   3.822993898320188*^9, 3.822993933794783*^9}, {3.822995612905003*^9, 
   3.8229956366264687`*^9}, 3.822997963838098*^9, 3.82299803111882*^9, {
   3.822998433590272*^9, 3.822998448195033*^9}, {3.823071448240654*^9, 
   3.82307145581317*^9}, {3.8230888808226557`*^9, 3.82308888186759*^9}, 
   3.8233379206295433`*^9, {3.823338347225206*^9, 3.823338351454524*^9}, {
   3.823759390459138*^9, 3.8237593922406387`*^9}, {3.823759792731242*^9, 
   3.8237598008336277`*^9}, {3.823760959052451*^9, 3.823760961584742*^9}, {
   3.823855798949605*^9, 3.823855801813786*^9}, {3.823856122216352*^9, 
   3.823856124006175*^9}, {3.8238565256888723`*^9, 3.823856526244245*^9}, {
   3.8238566123003263`*^9, 3.8238566127165537`*^9}, {3.823856773427938*^9, 
   3.8238567761263447`*^9}, {3.8238617689699917`*^9, 3.823861769107245*^9}, {
   3.823864608637721*^9, 3.823864608783774*^9}, {3.82438280264825*^9, 
   3.8243828092086906`*^9}, {3.824383059592062*^9, 3.8243830625172167`*^9}, {
   3.8245397744042377`*^9, 3.8245397746072598`*^9}, {3.8251572102616377`*^9, 
   3.825157251052496*^9}, {3.8251816693591833`*^9, 3.825181678549287*^9}, {
   3.825426409507395*^9, 3.825426409658166*^9}, {3.825500263626821*^9, 
   3.825500301625929*^9}, {3.8255005395009203`*^9, 3.825500547929242*^9}, {
   3.8255006070702763`*^9, 3.825500614008856*^9}, {3.825501206201603*^9, 
   3.825501254778904*^9}, {3.8255071356829863`*^9, 3.825507135761488*^9}, {
   3.825578860286574*^9, 3.8255788958729362`*^9}, {3.8255792007541523`*^9, 
   3.825579224732092*^9}, {3.8273931592964277`*^9, 3.8273931767520523`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"47db962b-d903-42c4-9ebc-6910da4d132f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "//", "MatrixForm"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E0", ",", "vectors0"}], "}"}], "=", 
     RowBox[{"Eigensystem", "[", "H0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E1", ",", "vectors1"}], "}"}], "=", 
     RowBox[{"Eigensystem", "[", "H1", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"U0", "=", " ", 
     RowBox[{"Transpose", "[", "vectors0", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U1", "=", 
     RowBox[{"Transpose", "[", "vectors1", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h0", "=", 
     RowBox[{"DiagonalMatrix", "[", "E0", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h1", "=", 
     RowBox[{"DiagonalMatrix", "[", "E1", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"M", " ", "Matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "U1", "]"}], ".", "U0"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]matrix", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"\[Mu]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"nF", ",", "nFlist", ",", "sum"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"T", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nFlist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"E0", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "<=", "EF"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"nFlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"nFlist", ",", "1"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nFlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"nFlist", ",", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "L", ",", "1"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nF", "=", 
        RowBox[{"DiagonalMatrix", "[", "nFlist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"Total", "[", "nFlist", "]"}]}]}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"If", " ", "nonzero", " ", "temperature"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "h0", " ", "and", " ", "\[Mu]matrix", " ", "are", " ", "diagonal", " ",
         "matrices", " ", "so", " ", "Exp", " ", "function", " ", "is", " ", 
        "quicker", " ", "than", " ", "MatrixExp"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"denominatorlist", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"E0", "-", "\[Mu]matrix"}], ")"}], "/", "T"}], "]"}], "+",
          "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"1", "/", "denominatorlist"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Find", " ", "chemical", " ", "potential"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]sol", "=", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"sum", "\[Equal]", "Ns"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\[Mu]sol", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominatorlist", "=", 
        RowBox[{"denominatorlist", "/.", "\[Mu]sol"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nF", "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"1", "/", "denominatorlist"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",\

 CellChangeTimes->{{3.822989424705098*^9, 3.8229894322340393`*^9}, {
   3.822993245059613*^9, 3.8229932485049963`*^9}, {3.822993624431518*^9, 
   3.822993624923649*^9}, {3.8229938272812767`*^9, 3.822993851494309*^9}, {
   3.822993898320188*^9, 3.822993933794783*^9}, {3.822995612905003*^9, 
   3.8229956366264687`*^9}, 3.822997963838098*^9, 3.82299803111882*^9, {
   3.822998433590272*^9, 3.822998448195033*^9}, {3.823071448240654*^9, 
   3.82307145581317*^9}, {3.8230888808226557`*^9, 3.82308888186759*^9}, 
   3.8233379206295433`*^9, {3.823338347225206*^9, 3.823338351454524*^9}, {
   3.823759390459138*^9, 3.8237593922406387`*^9}, {3.823759792731242*^9, 
   3.8237598008336277`*^9}, {3.823760959052451*^9, 3.823760961584742*^9}, {
   3.823855798949605*^9, 3.823855801813786*^9}, {3.823856122216352*^9, 
   3.823856124006175*^9}, {3.8238565256888723`*^9, 3.823856526244245*^9}, {
   3.8238566123003263`*^9, 3.8238566127165537`*^9}, {3.823856773427938*^9, 
   3.8238567761263447`*^9}, {3.8238617689699917`*^9, 3.823861769107245*^9}, {
   3.823864608637721*^9, 3.823864608783774*^9}, {3.82438280264825*^9, 
   3.8243828092086906`*^9}, {3.824383059592062*^9, 3.8243830625172167`*^9}, {
   3.8245397744042377`*^9, 3.8245397746072598`*^9}, {3.8251572102616377`*^9, 
   3.825157251052496*^9}, {3.8251816693591833`*^9, 3.825181678549287*^9}, {
   3.825426409507395*^9, 3.825426409658166*^9}, {3.825500263626821*^9, 
   3.825500301625929*^9}, {3.8255005395009203`*^9, 3.825500547929242*^9}, {
   3.8255006070702763`*^9, 3.825500614008856*^9}, {3.825501206201603*^9, 
   3.825501254778904*^9}, {3.8255071356829863`*^9, 3.825507135761488*^9}, {
   3.825578860286574*^9, 3.8255788958729362`*^9}, {3.8255792007541523`*^9, 
   3.825579224732092*^9}, {3.8273931592964277`*^9, 3.8273931767520523`*^9}, {
   3.827399013738216*^9, 3.8273990167631083`*^9}, {3.827399054865076*^9, 
   3.827399099382676*^9}, {3.882618973819179*^9, 
   3.88261897530262*^9}},ExpressionUUID->"af949841-73ec-45da-a887-\
60f477374889"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Mu]", "\[Rule]", "0.`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.836383680813281*^9, 3.8363846213283873`*^9, 3.8363850229910192`*^9, 
   3.8363911328691072`*^9, {3.836391821225728*^9, 3.836391846068615*^9}, 
   3.836394203189054*^9, 3.836462036318707*^9, 3.836467314191556*^9, 
   3.8364681662375507`*^9, 3.836468896697834*^9, 3.836474823439042*^9, 
   3.8364760019222183`*^9, 3.836482247114558*^9, 3.836483122474832*^9, 
   3.8364879880671*^9, 3.882618786160571*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"70993ea4-133f-45da-889b-752582cf5e94"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Check", " ", "matrix", " ", "M", " ", "normalization"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8230713223994217`*^9, 3.8230713328674707`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"ae66e1c8-f103-40ab-9f13-4d146b4c82af"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"i", "\[LessEqual]", "L"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sum", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"sum", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "10", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"i", "=", 
     RowBox[{"i", "+", "1"}]}]}]}], "]"}], "\n", 
 RowBox[{"Sqrt", "[", 
  RowBox[{"Total", "[", "sum", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.823071099692535*^9, 3.823071175647437*^9}, {
  3.823071299028599*^9, 3.823071301558374*^9}, {3.823071811333709*^9, 
  3.8230718303108263`*^9}, {3.8230776404972067`*^9, 3.823077643920189*^9}, {
  3.823077965024745*^9, 3.823077965918001*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"8a172f8f-9ca8-44c2-bb04-d1ec56ab90f7"],

Cell[BoxData["0.9999999999999997`"], "Output",
 CellChangeTimes->{
  3.823077266392857*^9, 3.823077614817515*^9, 3.8230776828346043`*^9, 
   3.823077801131199*^9, 3.823077995116699*^9, 3.8230782463587513`*^9, 
   3.82307838988579*^9, 3.8230785559882317`*^9, 3.82309412256453*^9, 
   3.823157203381711*^9, 3.8233390075214453`*^9, 3.8233393181747427`*^9, 
   3.823339556013253*^9, 3.823679324988804*^9, 3.823679896543653*^9, 
   3.823680074255124*^9, 3.823760249943701*^9, 3.823760967185506*^9, 
   3.823849307403207*^9, 3.823856932617197*^9, 3.823858116049638*^9, 
   3.823858398356903*^9, 3.823858623626395*^9, 3.823858968666382*^9, 
   3.823859271578506*^9, 3.823859646637712*^9, 3.823860450911298*^9, 
   3.823861055453141*^9, 3.8238613092615137`*^9, 3.82386177202918*^9, 
   3.823862041725903*^9, 3.823862298666204*^9, 3.8238623588152122`*^9, 
   3.823862514365238*^9, 3.823862616018447*^9, 3.8238627483867893`*^9, 
   3.82386300564062*^9, 3.8238634562864933`*^9, 3.8238635915890427`*^9, 
   3.823863726257815*^9, 3.823863983728393*^9, 3.8238643158630657`*^9, 
   3.823864440607768*^9, 3.823864612069696*^9, 3.823864920258409*^9, 
   3.8238654635559683`*^9, 3.823867132481062*^9, 3.8238822387447977`*^9, 
   3.8238825692445173`*^9, 3.8238881473629713`*^9, 3.8238882547531433`*^9, 
   3.823929614585855*^9, 3.823930464772801*^9, 3.823930966438328*^9, 
   3.823931660088925*^9, 3.823934716016657*^9, 3.823935858009327*^9, 
   3.823937802621077*^9, 3.823940052766654*^9, 3.823940934110853*^9, 
   3.825157256414043*^9, 3.8254051948100986`*^9, 3.8363245170279016`*^9, 
   3.836324573536528*^9, 3.836324744246482*^9, 3.8363261591066113`*^9, 
   3.8363780166234207`*^9, 3.836378540055438*^9, 3.8363790685863733`*^9, 
   3.836381167311562*^9, 3.8363818411728687`*^9, 3.836382722027246*^9, 
   3.83638368094016*^9, 3.836384621404517*^9, 3.836385023055435*^9, 
   3.8363911329192953`*^9, {3.836391821327325*^9, 3.836391846130417*^9}, 
   3.836394203282495*^9, 3.836462036377981*^9, 3.836467314285036*^9, 
   3.836468166289764*^9, 3.836468896821313*^9, 3.836474823487047*^9, 
   3.836476001965126*^9, 3.836482247163027*^9, 3.8364831225328913`*^9, 
   3.8364879881703377`*^9, 3.8826187862154827`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"c0097c45-6aab-4809-ac82-ca491919fe05"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Decoherence", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "\[Nu]List", "]"}], "\n", 
   RowBox[{
    RowBox[{"\[Delta]t", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax", "=", "200"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]List", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "L", "]"}], "-", "nF", "+", 
           RowBox[{"nF", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatrixExp", "[", 
               RowBox[{"I", " ", "h0", " ", "t"}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ConjugateTranspose", "[", "M", "]"}], ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatrixExp", "[", 
                   RowBox[{
                    RowBox[{"-", "I"}], " ", "h1", " ", "t"}], "]"}], ".", 
                  "M"}], ")"}]}], ")"}]}], ")"}]}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax", ",", "\[Delta]t"}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.818156153651724*^9, 3.8181561643391523`*^9}, 
   3.81935485967317*^9, {3.820213875040934*^9, 3.820213875172008*^9}, {
   3.820432830932143*^9, 3.8204328328093243`*^9}, {3.82047484272392*^9, 
   3.820474843052534*^9}, {3.8230712749379253`*^9, 3.823071283161193*^9}, {
   3.823072412572112*^9, 3.823072412894456*^9}, {3.823074385199339*^9, 
   3.8230743855200577`*^9}, {3.823079033404417*^9, 3.8230790339408407`*^9}, {
   3.8230828280709963`*^9, 3.82308282817667*^9}, 3.823083015155748*^9, {
   3.823085809383663*^9, 3.823085810258594*^9}, {3.8231568303592577`*^9, 
   3.82315683155698*^9}, {3.823157024382606*^9, 3.823157025559588*^9}, {
   3.823157130198132*^9, 3.823157131081607*^9}, {3.8231573132869987`*^9, 
   3.823157319526432*^9}, {3.8231575144740353`*^9, 3.823157518216724*^9}, {
   3.8232453979923887`*^9, 3.823245400458232*^9}, {3.8233388016767607`*^9, 
   3.8233388019192123`*^9}, {3.823759924253043*^9, 3.823759924641843*^9}, {
   3.823856240780278*^9, 3.823856241216861*^9}, {3.823856814311637*^9, 
   3.823856817367806*^9}, {3.823858083855173*^9, 3.823858084221987*^9}, {
   3.82388222613656*^9, 3.8238822264103394`*^9}, {3.823929568324461*^9, 
   3.823929568466599*^9}, {3.8239296007247868`*^9, 3.823929600853876*^9}, {
   3.836326133728257*^9, 3.8363261376449537`*^9}, {3.8826186212690687`*^9, 
   3.8826186246518583`*^9}, {3.882619805607604*^9, 
   3.8826198145653133`*^9}},ExpressionUUID->"0cfa8db8-4edd-419a-b5ae-\
89414a8d823d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Nu]AbsList", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Nu]AbsList", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"\[Nu]AbsList", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Nu]List", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"\[Nu]List", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "\[Nu]List", "]"}], ",", "1"}], "}"}]}], "]"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8057556296291647`*^9, 3.8057557219720297`*^9}, {
   3.8057557821882067`*^9, 3.805755831638812*^9}, {3.805755864089465*^9, 
   3.805755916065431*^9}, {3.810985967118359*^9, 3.8109859763919287`*^9}, {
   3.810986048827651*^9, 3.810986055281193*^9}, 3.812369507086072*^9, {
   3.812397733545734*^9, 3.812397734713777*^9}, {3.823156192635343*^9, 
   3.823156196403363*^9}, {3.823156743037162*^9, 3.8231567494554873`*^9}, {
   3.8231568646611643`*^9, 3.82315686783523*^9}, {3.836326140668171*^9, 
   3.836326143267817*^9}, {3.882618627237915*^9, 3.882618629515608*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"e78f5ceb-8b8a-4222-a4c6-8858d658d303"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"\[Nu]AbsList", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "100"}], "}"}], ",", "All"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.882619878805399*^9, 3.882619907112138*^9}, {
  3.88261996161092*^9, 3.8826199753901577`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"e521c996-1af3-4544-8224-d0f2595d5043"]
},
WindowSize->{1410, 760},
WindowMargins->{{-33, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3087, 56, 157, "Input",ExpressionUUID->"93f06ac2-1b44-4190-8fae-7347796b9841"],
Cell[3648, 78, 5977, 91, 199, "Input",ExpressionUUID->"246e4b5a-a216-488c-8a27-9a04c76ec6e4"],
Cell[9628, 171, 172, 3, 30, "Input",ExpressionUUID->"98c52fe7-8b34-4013-ba1d-c51a1f7d6f29"],
Cell[9803, 176, 3834, 89, 283, "Input",ExpressionUUID->"47db962b-d903-42c4-9ebc-6910da4d132f"],
Cell[CellGroupData[{
Cell[13662, 269, 6540, 150, 850, "Input",ExpressionUUID->"af949841-73ec-45da-a887-60f477374889"],
Cell[20205, 421, 616, 12, 24, "Print",ExpressionUUID->"70993ea4-133f-45da-889b-752582cf5e94"]
}, Open  ]],
Cell[20836, 436, 267, 5, 30, "Input",ExpressionUUID->"ae66e1c8-f103-40ab-9f13-4d146b4c82af"],
Cell[CellGroupData[{
Cell[21128, 445, 1154, 29, 136, "Input",ExpressionUUID->"8a172f8f-9ca8-44c2-bb04-d1ec56ab90f7"],
Cell[22285, 476, 2271, 32, 34, "Output",ExpressionUUID->"c0097c45-6aab-4809-ac82-ca491919fe05"]
}, Open  ]],
Cell[24571, 511, 2803, 56, 136, "Input",ExpressionUUID->"0cfa8db8-4edd-419a-b5ae-89414a8d823d"],
Cell[27377, 569, 1644, 36, 136, "Input",ExpressionUUID->"e78f5ceb-8b8a-4222-a4c6-8858d658d303"],
Cell[29024, 607, 441, 11, 30, "Input",ExpressionUUID->"e521c996-1af3-4544-8224-d0f2595d5043"]
}
]
*)

